# See more -> https://stash.wiki/
# è§„åˆ™æ¨¡å¼ï¼šruleï¼ˆè§„åˆ™ï¼‰ / globalï¼ˆå…¨å±€ä»£ç†ï¼‰/ directï¼ˆå…¨å±€ç›´è¿ï¼‰
mode: rule

# è®¾ç½®æ—¥å¿—è¾“å‡ºçº§åˆ« (é»˜è®¤çº§åˆ«ï¼šsilentï¼Œå³ä¸è¾“å‡ºä»»ä½•å†…å®¹ï¼Œä»¥é¿å…å› æ—¥å¿—å†…å®¹è¿‡å¤§è€Œå¯¼è‡´ç¨‹åºå†…å­˜æº¢å‡ºï¼‰ã€‚
# 5 ä¸ªçº§åˆ«ï¼šsilent / info / warning / error / debugã€‚çº§åˆ«è¶Šé«˜æ—¥å¿—è¾“å‡ºé‡è¶Šå¤§ï¼Œè¶Šå€¾å‘äºè°ƒè¯•ï¼Œè‹¥éœ€è¦è¯·è‡ªè¡Œå¼€å¯ã€‚
log-level: info

# subscribe-url: å­—æ®µåªä¼šè§£ææœåŠ¡ä¿¡æ¯ï¼Œå¹¶ä¸ä¼šä½œä¸ºå®šæ—¶æ›´æ–° URLã€‚
subscribe-url: http://your-service-provider
proxy-providers:
  provider1:
    url: https://raw.githubusercontent.com/STASH-NETWORKS-LIMITED/stash-example/main/config.yaml
    interval: 3600
    health-check:
      enable: true
      interval: 600
      url: http://www.gstatic.com/generate_204
  # æœåŠ¡æä¾›å•†-2:
  #   url: http://your-another-service-provider
  #   interval: 600

# æ”¯æŒé€šé…ç¬¦åŸŸå (ä¾‹å¦‚: *.clash.dev, *.foo.*.example.com )
# ä¸ä½¿ç”¨é€šé…ç¬¦çš„åŸŸåä¼˜å…ˆçº§é«˜äºä½¿ç”¨é€šé…ç¬¦çš„åŸŸå (ä¾‹å¦‚: foo.example.com > *.example.com > .example.com )
# æ³¨æ„: +.foo.com çš„æ•ˆæœç­‰åŒäº .foo.com å’Œ foo.com
hosts:
  "*.clash.dev": 127.0.0.1
  ".dev": 127.0.0.1
  "alpha.clash.dev": "::1"

# DNS æœåŠ¡å™¨é…ç½®
dns:
  # ä»¥ä¸‹å¡«å†™çš„ DNS æœåŠ¡å™¨å°†ä¼šè¢«ç”¨æ¥è§£æ DNS æœåŠ¡çš„åŸŸå
  # ä»…å¡«å†™ DNS æœåŠ¡å™¨çš„ IP åœ°å€
  default-nameserver:
    - 223.5.5.5
    - 114.114.114.114
    - system # ä½¿ç”¨ iOS ç³»ç»Ÿ DNS
  # æ”¯æŒ UDP / TCP / DoT / DoH åè®®çš„ DNS æœåŠ¡ï¼Œå¯ä»¥æŒ‡æ˜å…·ä½“çš„è¿æ¥ç«¯å£å·ã€‚
  # æ‰€æœ‰ DNS è¯·æ±‚å°†ä¼šç›´æ¥å‘é€åˆ°æœåŠ¡å™¨ï¼Œä¸ç»è¿‡ä»»ä½•ä»£ç†ã€‚
  # Stash ä¼šä½¿ç”¨æœ€å…ˆè·å¾—çš„è§£æè®°å½•å›å¤ DNS è¯·æ±‚
  nameserver:
    # ä¸å»ºè®®é…ç½®è¶…è¿‡ 2 ä¸ª DNS æœåŠ¡å™¨ï¼Œä¼šå¢åŠ ç³»ç»ŸåŠŸè€—
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
    # - quic://dns.adguard.com:853
    # - doq://test.dns.nextdns.io:853
    - system # ä½¿ç”¨ iOS ç³»ç»Ÿ DNS

  # è·³è¿‡è¯ä¹¦éªŒè¯ï¼Œè§£å†³éƒ¨åˆ†å…¼å®¹æ€§é—®é¢˜ https://help.nextdns.io/t/g9hdkjz
  skip-cert-verify: true

  # å¯¹éƒ¨åˆ†åŸŸåä½¿ç”¨å•ç‹¬çš„ DNS æœåŠ¡å™¨
  nameserver-policy:
    "www.baidu.com": 114.114.114.114
    "+.internal.crop.com": system

  # åœ¨ä»¥ä¸‹åˆ—è¡¨çš„åŸŸåå°†ä¸ä¼šè¢«è§£æä¸º fake ipï¼Œè¿™äº›åŸŸåç›¸å…³çš„è§£æè¯·æ±‚å°†ä¼šè¿”å›å®ƒä»¬çœŸå®çš„ IP åœ°å€
  fake-ip-filter:
    # from: https://github.com/Kr328/ClashForAndroid/blob/ffa559a57102ed8bc20eba41aa236a7764741bf9/core/src/main/golang/native/config/defaults.go#L10

    # Stun Services
    - "+.stun.*.*"
    - "+.stun.*.*.*"
    - "+.stun.*.*.*.*"
    - "+.stun.*.*.*.*.*"

    # Google Voices
    - "lens.l.google.com"

    # Nintendo Switch
    - "*.n.n.srv.nintendo.net"

    # PlayStation
    - "+.stun.playstation.net"

    # XBox
    - "xbox.*.*.microsoft.com"
    - "*.*.xboxlive.com"

    # Microsoft
    - "*.msftncsi.com"
    - "*.msftconnecttest.com"

    # Bilibili CDN
    - "*.mcdn.bilivideo.cn"

proxies:
  # shadowsocks
  # æ”¯æŒåŠ å¯†æ–¹å¼ï¼š
  #   aes-128-gcm aes-192-gcm aes-256-gcm
  #   aes-128-cfb aes-192-cfb aes-256-cfb
  #   aes-128-ctr aes-192-ctr aes-256-ctr
  #   rc4-md5 chacha20 chacha20-ietf xchacha20
  #   chacha20-ietf-poly1305 xchacha20-ietf-poly1305
  - name: "ss1"
    type: ss
    server: server
    port: 443
    cipher: chacha20-ietf-poly1305
    password: "password"
    udp: true

  - name: "ss2"
    type: ss
    server: server
    port: 443
    cipher: AEAD_CHACHA20_POLY1305
    password: "password"
    plugin: obfs
    plugin-opts:
      mode: tls # æ··æ·†æ¨¡å¼ï¼Œå¯ä»¥é€‰æ‹© http æˆ– tls
      host: bing.com # æ··æ·†åŸŸåï¼Œéœ€è¦å’ŒæœåŠ¡å™¨é…ç½®ä¿æŒä¸€è‡´

  - name: "ss3"
    type: ss
    server: server
    port: 443
    cipher: AEAD_CHACHA20_POLY1305
    password: "password"
    plugin: v2ray-plugin
    plugin-opts:
      mode: websocket # æš‚æ—¶ä¸æ”¯æŒ QUIC åè®®
      tls: true # wss
      skip-cert-verify: true
      host: bing.com
      path: "/"
      headers:
        custom: value

  # vmess
  # æ”¯æŒåŠ å¯†æ–¹å¼ï¼šauto / aes-128-gcm / chacha20-poly1305 / none
  - name: "vmess"
    type: vmess
    server: server
    port: 443
    uuid: d0529668-8835-11ec-a8a3-0242ac120002
    alterId: 32
    cipher: auto
    udp: true
    tls: true
    skip-cert-verify: true
    servername: example.com # ä¼˜å…ˆçº§é«˜äº wss host
    network: ws
    ws-opts:
      path: /path
      headers:
        Host: v2ray.com
      max-early-data: 2048
      early-data-header-name: Sec-WebSocket-Protocol

  - name: "vmess-h2"
    type: vmess
    server: server
    port: 443
    uuid: d0529668-8835-11ec-a8a3-0242ac120002
    alterId: 32
    cipher: auto
    network: h2
    tls: true
    h2-opts:
      host:
        - http.example.com
        - http-alt.example.com
      path: /

  - name: "vmess-http"
    type: vmess
    server: server
    port: 443
    uuid: d0529668-8835-11ec-a8a3-0242ac120002
    alterId: 32
    cipher: auto
    udp: true
    network: http
    http-opts:
      method: "GET"
      path:
        - "/"
        - "/video"
      headers:
        Connection:
          - keep-alive

  - name: "vmess-grpc"
    server: server
    port: 443
    type: vmess
    uuid: d0529668-8835-11ec-a8a3-0242ac120002
    alterId: 32
    cipher: auto
    network: grpc
    tls: true
    servername: example.com
    skip-cert-verify: true
    grpc-opts:
      grpc-service-name: "example"

  # socks5
  - name: "socks"
    type: socks5
    server: server
    port: 443
    username: username
    password: password
    tls: true
    skip-cert-verify: true
    udp: true

  # http
  - name: "http"
    type: http
    server: server
    port: 443
    username: username
    password: password
    tls: true # https
    skip-cert-verify: true

  # snell
  - name: "snell"
    type: snell
    server: server
    port: 44046
    psk: yourpsk
    udp: true # éœ€è¦ v3 ä»¥ä¸ŠæœåŠ¡ç«¯
    version: 3
    obfs-opts:
      mode: http # æˆ– tls
      host: bing.com

  # Trojan
  - name: "trojan"
    type: trojan
    server: server
    port: 443
    password: yourpsk
    udp: true
    sni: example.com # Server Name Indicationï¼Œå¦‚æœç©ºä¼šä½¿ç”¨ server ä¸­çš„å€¼
    alpn:
      - h2
      - http/1.1
    skip-cert-verify: true

  # hysteria https://github.com/HyNetwork/hysteria/wiki/%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95
  - name: "hysteria"
    type: hysteria
    server: server
    port: 443
    up-speed: 100 # ä¸Šä¼ å¸¦å®½ï¼ˆå•ä½ï¼šMbpsï¼‰
    down-speed: 100 # ä¸‹è½½å¸¦å®½ï¼ˆå•ä½ï¼šMbpsï¼‰
    auth: "" # bytes encoded in base64
    protocol: "" # udp / wechat-video
    obfs: "" # obfs password
    udp: true
    sni: example.com # Server Name Indicationï¼Œå¦‚æœç©ºä¼šä½¿ç”¨ server ä¸­çš„å€¼
    alpn:
      - hysteria
    skip-cert-verify: true

  # ShadowsocksR
  # æ”¯æŒçš„åŠ å¯†æ–¹å¼: SS ä¸­æ”¯æŒçš„æ‰€æœ‰æµåŠ å¯†æ–¹å¼
  # æ”¯æŒçš„æ··æ·†æ–¹å¼:
  #   plain http_simple http_post
  #   random_head tls1.2_ticket_auth tls1.2_ticket_fastauth
  # æ”¯æŒçš„åè®®:
  #   origin auth_sha1_v4 auth_aes128_md5
  #   auth_aes128_sha1 auth_chain_a auth_chain_b
  - name: "ssr"
    type: ssr
    server: server
    port: 443
    cipher: chacha20-ietf
    password: "password"
    obfs: tls1.2_ticket_auth
    protocol: auth_sha1_v4
    obfs-param: domain.tld
    protocol-param: "#"
    udp: true

  - name: "vless"
    type: vless
    server: server
    port: 443
    uuid: d0529668-8835-11ec-a8a3-0242ac120002
    flow: xtls-rprx-direct
    skip-cert-verify: true
    network: h2
    tls: true
    ws-opts:
      path: /path
      headers:
        Host: v2ray.com
    grpc-opts:
      grpc-service-name: "example"
    h2-opts:
      host:
        - http.example.com
        - http-alt.example.com
      path: /

proxy-groups:
  # ä»£ç†çš„è½¬å‘é“¾, åœ¨ proxies ä¸­ä¸åº”è¯¥åŒ…å« relay. ä¸æ”¯æŒ UDP.
  # æµé‡: clash <-> http <-> vmess <-> ss1 <-> ss2 <-> äº’è”ç½‘
  - name: "relay"
    type: relay
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Direct.png
    proxies:
      - http
      - vmess
      - ss1
      - ss2

  - name: my-s
    type: select
    include-all: true # å¼•ç”¨æ‰€æœ‰ proxies & proxy-providers
    filter: "s2|s1" # ç­›é€‰å«æœ‰ s1 æˆ– s2 å…³é”®å­—çš„ä»£ç†

  # url-test å¯ä»¥è‡ªåŠ¨é€‰æ‹©ä¸æŒ‡å®š URL æµ‹é€Ÿåï¼Œå»¶è¿Ÿæœ€çŸ­çš„æœåŠ¡å™¨
  - name: "auto"
    type: url-test
    proxies:
      - ss1
      - ss2
      - vmess
    url: "http://www.gstatic.com/generate_204"
    interval: 300

  # fallback å¯ä»¥å°½é‡æŒ‰ç…§ç”¨æˆ·ä¹¦å†™çš„æœåŠ¡å™¨é¡ºåºï¼Œåœ¨ç¡®ä¿æœåŠ¡å™¨å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œè‡ªåŠ¨é€‰æ‹©æœåŠ¡å™¨
  - name: "fallback-auto"
    type: fallback
    proxies:
      - ss1
      - ss2
      - vmess
    url: "http://www.gstatic.com/generate_204"
    interval: 300

  # load-balance å¯ä»¥ä½¿ç›¸åŒ eTLD è¯·æ±‚åœ¨åŒä¸€æ¡ä»£ç†çº¿è·¯ä¸Š
  - name: "load-balance"
    type: load-balance
    proxies:
      - ss1
      - ss2
      - vmess
    url: "http://www.gstatic.com/generate_204"
    interval: 300

  # select ç”¨æ¥å…è®¸ç”¨æˆ·æ‰‹åŠ¨é€‰æ‹© ä»£ç†æœåŠ¡å™¨ æˆ– æœåŠ¡å™¨ç»„
  # æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ RESTful API å»åˆ‡æ¢æœåŠ¡å™¨ï¼Œè¿™ç§æ–¹å¼æ¨èåœ¨ GUI ä¸­ä½¿ç”¨
  - name: Proxy2
    type: select
    proxies:
      - ss1
      - ss2
      - vmess
      - auto

  # åŸºäº SSID çš„ç­–ç•¥ï¼Œæ–¹ä¾¿åœ¨ç‰¹æ®Šç½‘ç»œç¯å¢ƒä¸‹ä½¿ç”¨ç‰¹å®šçš„ä»£ç†
  - name: ssid-group
    type: select # ç±»å‹å¿…é¡»ä¸º selectï¼Œå…¼å®¹åŸç‰ˆ clash é…ç½®
    proxies:
      - ss1
      - ss2
      - DIRECT
    ssid-policy:
      # åœ¨ SSID ä¸º office çš„ Wi-Fi ä¸­è‡ªåŠ¨åˆ‡æ¢ä¸º ss1 ç­–ç•¥
      # åœ¨ SSID ä¸º home çš„ Wi-Fi ä¸­è‡ªåŠ¨åˆ‡æ¢ä¸º ss2 ç­–ç•¥
      # åœ¨èœ‚çªæ•°æ®ä¸­è‡ªåŠ¨åˆ‡æ¢ä¸º ss1 ç­–ç•¥
      # å…¶ä»–çš„ SSID é»˜è®¤ä¸º DIRECT
      office: ss1
      home: ss2
      cellular: ss1
      default: DIRECT

  - name: UseProvider
    type: select
    use:
      - provider1
    proxies:
      - Proxy
      - DIRECT

  # åŠŸèƒ½åˆ†ç»„
  - name: é€‰æ‹©ä»£ç†
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/mini/Proxy.png
    type: select
    proxies: &proxies
      - è‡ªåŠ¨é€‰æ‹©
      - HK é¦™æ¸¯
      - TW å°æ¹¾
      - SG æ–°åŠ å¡
      - JP æ—¥æœ¬
      - US ç¾å›½
      - DIRECT

  - name: Netflix
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/mini/Netflix.png
    type: select
    proxies: *proxies

  - name: Disney+
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/mini/Disney%2B.png
    type: select
    proxies: *proxies

  - name: Spotify
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/mini/Spotify.png
    type: select
    proxies: *proxies

  - name: YouTube
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/mini/YouTube.png
    type: select
    proxies: *proxies

  - name: Speedtest
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/mini/Speedtest.png
    type: select
    proxies: *proxies

  - name: é»˜è®¤
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/mini/Final.png
    type: select
    proxies:
      - é€‰æ‹©ä»£ç†
      - DIRECT

  # åŸºäºåœ°åŒºåˆ†ç»„
  - name: HK é¦™æ¸¯
    filter: "æ¸¯|ğŸ‡­ğŸ‡°|HK|(?i)Hong"
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/mini/Hong_Kong.png
    interval: 120
    lazy: true
    tolerance: 50
    type: url-test
    url: http://cp.cloudflare.com/generate_204
    include-all: true

  - name: TW å°æ¹¾
    filter: "å°|ğŸ‡¨ğŸ‡³|ğŸ‡¹ğŸ‡¼|æ¹¾|TW|(?i)Taiwan"
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/mini/Taiwan.png
    interval: 120
    lazy: true
    tolerance: 50
    type: url-test
    url: http://cp.cloudflare.com/generate_204
    include-all: true

  - name: SG æ–°åŠ å¡
    filter: "æ–°åŠ å¡|å¡|ç‹®åŸ|ğŸ‡¸ğŸ‡¬|SG|(?i)Singapore"
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/mini/Singapore.png
    interval: 120
    lazy: true
    tolerance: 50
    type: url-test
    url: http://cp.cloudflare.com/generate_204
    include-all: true

  - name: JP æ—¥æœ¬
    filter: "æ—¥|ğŸ‡¯ğŸ‡µ|ä¸œäº¬|JP|(?i)Japan"
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/mini/Japan.png
    interval: 120
    lazy: true
    tolerance: 50
    type: url-test
    url: http://cp.cloudflare.com/generate_204
    include-all: true

  - name: US ç¾å›½
    filter: "ç¾|ğŸ‡ºğŸ‡²|US|(?i)States|American"
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/mini/United_States.png
    interval: 120
    lazy: true
    tolerance: 50
    type: url-test
    url: http://cp.cloudflare.com/generate_204
    include-all: true

  - name: è‡ªåŠ¨é€‰æ‹©
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/mini/Proxy.png
    interval: 120
    lazy: true
    tolerance: 50
    type: url-test
    url: http://cp.cloudflare.com/generate_204
    include-all: true

rules:
  - SCRIPT,quic,REJECT

  # Netflix
  - RULE-SET,netflix,Netflix
  # Disney+
  - RULE-SET,disney,Disney+
  # Spotify
  - RULE-SET,spotify,Spotify
  # Speedtest
  - RULE-SET,speedtest,Speedtest
  # GitHub
  - RULE-SET,github,é€‰æ‹©ä»£ç†
  # Telegram
  - IP-ASN,62014,é€‰æ‹©ä»£ç†,no-resolve
  - IP-ASN,59930,é€‰æ‹©ä»£ç†,no-resolve
  - IP-ASN,44907,é€‰æ‹©ä»£ç†,no-resolve
  - IP-ASN,211157,é€‰æ‹©ä»£ç†,no-resolve
  - PROCESS-NAME,Telegram.exe,é€‰æ‹©ä»£ç†
  - PROCESS-NAME,Telegram,é€‰æ‹©ä»£ç†
  - RULE-SET,telegram,é€‰æ‹©ä»£ç†
  # YouTube
  - RULE-SET,youtube,YouTube
  # Google
  - RULE-SET,google,é€‰æ‹©ä»£ç†
  # Twitter
  - RULE-SET,twitter,é€‰æ‹©ä»£ç†
  - DOMAIN-SUFFIX,tapbots.com,é€‰æ‹©ä»£ç†
  # Instagram
  - RULE-SET,instagram,é€‰æ‹©ä»£ç†
  # Facebook
  - RULE-SET,facebook,é€‰æ‹©ä»£ç†
  # Steam
  - RULE-SET,steam@cn,DIRECT
  - RULE-SET,steam,é€‰æ‹©ä»£ç†
  # Apple LBS
  - DOMAIN-SUFFIX,iphone-ld.apple.com,DIRECT
  - DOMAIN-SUFFIX,lcdn-locator.apple.com,DIRECT
  - DOMAIN-SUFFIX,lcdn-registration.apple.com,DIRECT
  - DOMAIN-SUFFIX,push.apple.com,DIRECT
  # Apple OCSP
  - PROCESS-NAME,trustd,é€‰æ‹©ä»£ç†
  # Microsoft
  - RULE-SET,microsoft@cn,DIRECT
  - RULE-SET,microsoft,é€‰æ‹©ä»£ç†
  - RULE-SET,xbox,é€‰æ‹©ä»£ç†
  # common proxy utils
  - PROCESS-NAME,v2ray,DIRECT
  - PROCESS-NAME,Surge,DIRECT
  - PROCESS-NAME,ss-local,DIRECT
  - PROCESS-NAME,privoxy,DIRECT
  - PROCESS-NAME,trojan,DIRECT
  - PROCESS-NAME,trojan-go,DIRECT
  - PROCESS-NAME,naive,DIRECT
  - PROCESS-NAME,CloudflareWARP,DIRECT
  - PROCESS-NAME,Cloudflare WARP,DIRECT
  - IP-CIDR,162.159.193.0/24,DIRECT,no-resolve
  - PROCESS-NAME,p4pclient,DIRECT
  - PROCESS-NAME,Thunder,DIRECT
  - PROCESS-NAME,DownloadService,DIRECT
  - PROCESS-NAME,qbittorrent,DIRECT
  - PROCESS-NAME,Transmission,DIRECT
  - PROCESS-NAME,fdm,DIRECT
  - PROCESS-NAME,aria2c,DIRECT
  - PROCESS-NAME,Folx,DIRECT
  - PROCESS-NAME,NetTransport,DIRECT
  - PROCESS-NAME,uTorrent,DIRECT
  - PROCESS-NAME,WebTorrent,DIRECT

  - GEOIP,LAN,DIRECT
  - GEOIP,CN,DIRECT
  - MATCH,é»˜è®¤

rule-providers:
  netflix:
    behavior: domain
    interval: 86400
    url: https://rules.vercel.app/Stash/Rulesets/Domain/netflix.yaml
  disney:
    behavior: domain
    interval: 86400
    type: http
    url: https://rules.vercel.app/Stash/Rulesets/Domain/disney.yaml
  spotify:
    behavior: domain
    interval: 86400
    url: https://rules.vercel.app/Stash/Rulesets/Domain/Spotify.yaml
  speedtest:
    behavior: domain
    interval: 86400
    url: https://rules.vercel.app/Stash/Rulesets/Domain/speedtest.yaml
  github:
    behavior: domain
    interval: 86400
    url: https://rules.vercel.app/Stash/Rulesets/Domain/github.yaml
  telegram:
    behavior: domain
    interval: 86400
    url: https://rules.vercel.app/Stash/Rulesets/Domain/telegram.yaml
  youtube:
    behavior: domain
    interval: 86400
    url: https://rules.vercel.app/Stash/Rulesets/Domain/youtube.yaml
  google:
    behavior: domain
    interval: 86400
    url: https://rules.vercel.app/Stash/Rulesets/Domain/google.yaml
  twitter:
    behavior: domain
    interval: 86400
    url: https://rules.vercel.app/Stash/Rulesets/Domain/twitter.yaml
  instagram:
    behavior: domain
    interval: 86400
    url: https://rules.vercel.app/Stash/Rulesets/Domain/instagram.yaml
  facebook:
    behavior: domain
    interval: 86400
    url: https://rules.vercel.app/Stash/Rulesets/Domain/facebook.yaml
  steam:
    behavior: domain
    interval: 86400
    url: https://rules.vercel.app/Stash/Rulesets/Domain/steam.yaml
  steam@cn:
    behavior: domain
    interval: 86400
    url: https://rules.vercel.app/Stash/Rulesets/Domain/steam@cn.yaml
  microsoft:
    behavior: domain
    interval: 86400
    url: https://rules.vercel.app/Stash/Rulesets/Domain/microsoft.yaml
  microsoft@cn:
    behavior: domain
    interval: 86400
    url: https://rules.vercel.app/Stash/Rulesets/Domain/microsoft@cn.yaml
  xbox:
    behavior: domain
    interval: 86400
    url: https://rules.vercel.app/Stash/Rulesets/Domain/xbox.yaml
  outside:
    behavior: domain-text
    interval: 86400
    url: https://rules.vercel.app/Stash/Rulesets/DomainText/outside.yaml

# HTTP å¼•æ“ç›¸å…³
http:
  # å¼ºåˆ¶ä½¿ç”¨ HTTP å¼•æ“å¤„ç† TCP è¿æ¥
  # æ•è·åçš„è¿æ¥å¯ä»¥ä½¿ç”¨é«˜çº§åŠŸèƒ½ï¼Œä¾‹å¦‚é‡å†™å’Œè„šæœ¬
  force-http-engine:
    - "*:80"

  # HTTP(S) é‡å†™ï¼Œæ”¯æŒ headerã€302ã€307ã€reject å¤šç§ç­–ç•¥
  url-rewrite:
    - ^http://g\.cn http://www.google.com header # é‡å†™è¯·æ±‚å¤´çš„åŸŸå
    - ^https?://www\.google\.cn https://www.google.com 302 # ç›´æ¥è¿”å›ä¸€ä¸ª 302 é‡å®šå‘çš„å“åº”

  # ä½¿ç”¨ JavaScript è„šæœ¬æ”¹å†™ HTTP(S) è¯·æ±‚
  script:
    - match: https://weather-data.apple.com/v2/weather/[\w-]+/-?[0-9]+\.[0-9]+/-?[0-9]+\.[0-9]+\?
      name: weather-us-aqi # å¼•ç”¨ script-providers ä¸­çš„è„šæœ¬
      type: response # è„šæœ¬ç±»å‹ï¼šrequest / response
      require-body: true # å¦‚æœéœ€è¦ request / response bodyï¼Œè¯·è®¾ç½®ä¸º true
      timeout: 10 # script timeout in second (optional)
      argument: "" # script argument (optional)
      # debug: false # å¼€å‘æ¨¡å¼ï¼Œæ¯æ¬¡æ‰§è¡Œå‰ä¼šä» provider åŠ è½½æœ€æ–°è„šæœ¬

  # ä»¥ PKCS #12 ç¼–ç çš„ CA è¯ä¹¦
  ca: ""
  # è¯ä¹¦å¯†ç 
  ca-passphrase: ""
  # å¼€å¯ MitM åŠŸèƒ½çš„åŸŸååˆ—è¡¨ï¼Œéœ€è¦ç¡®ä¿ä¸Šè¿° CA è¯ä¹¦å·²å—ç³»ç»Ÿä¿¡ä»»
  mitm:
    - g.cn
    - "*.google.cn"
    - weather-data.apple.com # é»˜è®¤åªå¯¹ 443 ç«¯å£å¼€å¯
    - weather-data.apple.com:* # ä½¿ç”¨é€šé…ç¬¦å¯¹æ‰€æœ‰ç«¯å£å¼€å¯
    - "*.weather-data.apple.com" # åŸŸåä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨é€šé…ç¬¦
    - "-exclude.weather-data.apple.com" # ç”¨-å‰ç¼€æ’é™¤åŸŸå
script-providers:
  weather-us-aqi:
    url: https://raw.githubusercontent.com/STASH-NETWORKS-LIMITED/stash-example/main/script/iOS15_Weather_AQI_Standard.js
    interval: 86400

# å®šæ—¶ä»»åŠ¡
cron:
  # å®šæ—¶æ‰§è¡Œ JavaScript è„šæœ¬
  script:
    - name: weather-us-aqi # å¼•ç”¨ script-providers ä¸­çš„è„šæœ¬
      cron: "* * * * *" # cron è¡¨è¾¾å¼ï¼Œå¯ä»¥åœ¨ https://crontab.guru/ è·å–æ›´å¤šä»‹ç»
      timeout: 10 # script timeout in second (optional)
      argument: "" # script argument (optional)
      debug: false # å¼€å‘æ¨¡å¼ï¼Œæ¯æ¬¡æ‰§è¡Œå‰ä¼šä» provider åŠ è½½æœ€æ–°è„šæœ¬

script:
  shortcuts: # ä½¿ç”¨ Python è¡¨è¾¾å¼ç¼–å†™è‡ªå®šä¹‰è§„åˆ™
    # 4483 ä¸ 9305 ä¸º BiliBili çš„ QUIC CDN
    quic: network == 'udp' and (dst_port == 443 or dst_port == 4483 or dst_port == 9305) # å¯ä»¥åœ¨ rule ä¸­å¼•ç”¨

